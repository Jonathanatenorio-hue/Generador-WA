<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ExpertCell | Generador de Mensajes WhatsApp</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0B1120;--bg2:#0F172A;--bg3:rgba(15,23,42,0.7);
  --card:rgba(15,23,42,0.85);--card-border:rgba(100,116,139,0.12);
  --att:#009FDB;--att-dark:#0057B8;--att-navy:#1A1F3A;
  --text:#E2E8F0;--text2:#CBD5E1;--text3:#94A3B8;--text4:#64748B;
  --green:#10B981;--red:#EF4444;--yellow:#F59E0B;--blue:#3B82F6;
  --orange:#FF6B35;--purple:#8B5CF6;
  --input-bg:rgba(30,41,59,0.6);--input-border:rgba(100,116,139,0.25);
  --wa-light:#DCF8C6;--wa-dark:#075E54;--wa-green:#25D366;
}
body{font-family:'DM Sans',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
input,select,textarea,button{font-family:inherit}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(100,116,139,0.3);border-radius:3px}

.app{max-width:1200px;margin:0 auto;padding:20px 24px}

/* Header */
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid rgba(0,159,219,0.1)}
.brand{display:flex;align-items:center;gap:14px}
.brand-icon{width:42px;height:42px;border-radius:12px;background:linear-gradient(135deg,var(--att),var(--att-dark));display:flex;align-items:center;justify-content:center}
.brand-icon svg{width:22px;height:22px;color:white;fill:none;stroke:white;stroke-width:2}
.brand-text .label{font-size:10px;font-weight:700;letter-spacing:3px;color:var(--att);text-transform:uppercase}
.brand-text h1{font-size:18px;font-weight:800;color:var(--text);letter-spacing:-0.3px}
.agent-badge{display:flex;align-items:center;gap:8px;padding:8px 14px;background:rgba(0,159,219,0.08);border:1px solid rgba(0,159,219,0.15);border-radius:10px}
.agent-badge .dot{width:8px;height:8px;border-radius:50%;background:var(--green)}
.agent-badge span{font-size:12px;color:var(--text2);font-weight:500}

/* Layout */
.layout{display:grid;grid-template-columns:380px 1fr;gap:24px;align-items:start}

/* Input Panel */
.panel{background:var(--bg2);border:1px solid var(--card-border);border-radius:16px;padding:24px;position:sticky;top:20px}
.panel-title{font-size:14px;font-weight:700;color:var(--text);margin-bottom:4px;display:flex;align-items:center;gap:8px}
.panel-sub{font-size:11px;color:var(--text4);margin-bottom:20px}
.field{margin-bottom:16px}
.field label{display:block;font-size:11px;font-weight:600;color:var(--text3);margin-bottom:5px;letter-spacing:.5px;text-transform:uppercase}
.field input,.field select{width:100%;padding:11px 14px;background:var(--input-bg);border:1px solid var(--input-border);border-radius:10px;color:var(--text);font-size:13px;outline:none;transition:border .2s}
.field input:focus,.field select:focus{border-color:var(--att)}
.field input::placeholder{color:var(--text4)}
.field-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}

/* Scenario buttons */
.scenarios{display:flex;flex-direction:column;gap:6px;margin-top:16px}
.scenario-label{font-size:11px;font-weight:600;color:var(--text3);letter-spacing:.5px;text-transform:uppercase;margin-bottom:4px}
.scenario-btn{display:flex;align-items:center;gap:10px;width:100%;padding:12px 14px;background:rgba(30,41,59,0.4);border:1px solid rgba(100,116,139,0.15);border-radius:10px;color:var(--text2);font-size:13px;font-weight:500;cursor:pointer;transition:all .15s;text-align:left}
.scenario-btn:hover{background:rgba(0,159,219,0.06);border-color:rgba(0,159,219,0.2)}
.scenario-btn.active{background:rgba(0,159,219,0.1);border-color:rgba(0,159,219,0.3);color:var(--att);font-weight:600}
.scenario-btn .emoji{font-size:16px;width:24px;text-align:center;flex-shrink:0}
.scenario-btn .count{margin-left:auto;font-size:10px;color:var(--text4);background:rgba(100,116,139,0.15);padding:2px 7px;border-radius:10px}

/* Generate button */
.btn-generate{width:100%;padding:14px;background:linear-gradient(135deg,var(--wa-green),#128C7E);border:none;border-radius:12px;color:white;font-size:14px;font-weight:700;cursor:pointer;transition:all .2s;margin-top:16px;letter-spacing:.3px;display:flex;align-items:center;justify-content:center;gap:8px}
.btn-generate:hover{transform:translateY(-1px);box-shadow:0 8px 25px rgba(37,211,102,0.25)}
.btn-generate:disabled{opacity:.4;cursor:default;transform:none;box-shadow:none}
.btn-generate svg{width:18px;height:18px}

/* Results Panel */
.results{min-height:400px}
.results-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;text-align:center;padding:40px}
.results-empty .icon{width:80px;height:80px;border-radius:20px;background:rgba(0,159,219,0.06);display:flex;align-items:center;justify-content:center;margin-bottom:16px}
.results-empty .icon svg{width:36px;height:36px;stroke:var(--att);fill:none;stroke-width:1.5}
.results-empty h3{font-size:16px;font-weight:700;color:var(--text);margin-bottom:6px}
.results-empty p{font-size:13px;color:var(--text4);max-width:300px}

/* Comparison card */
.comparison{background:var(--bg2);border:1px solid var(--card-border);border-radius:14px;padding:18px 20px;margin-bottom:16px;animation:slideUp .4s ease}
.comparison-title{font-size:11px;font-weight:700;color:var(--att);letter-spacing:1px;text-transform:uppercase;margin-bottom:12px}
.compare-grid{display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:center}
.compare-box{padding:14px;border-radius:10px;text-align:center}
.compare-box.old{background:rgba(239,68,68,0.06);border:1px solid rgba(239,68,68,0.12)}
.compare-box.new{background:rgba(16,185,129,0.06);border:1px solid rgba(16,185,129,0.12)}
.compare-box .box-label{font-size:9px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:6px}
.compare-box.old .box-label{color:var(--red)}
.compare-box.new .box-label{color:var(--green)}
.compare-box .plan-name{font-size:13px;font-weight:700;color:var(--text);margin-bottom:4px}
.compare-box .plan-price{font-size:22px;font-weight:800;margin-bottom:2px}
.compare-box.old .plan-price{color:var(--red)}
.compare-box.new .plan-price{color:var(--green)}
.compare-box .plan-data{font-size:11px;color:var(--text3)}
.compare-arrow{font-size:24px;color:var(--att)}
.savings-strip{display:flex;justify-content:center;gap:20px;margin-top:12px;padding-top:12px;border-top:1px solid rgba(100,116,139,0.1)}
.saving-item{text-align:center}
.saving-item .val{font-size:16px;font-weight:800}
.saving-item .lbl{font-size:9px;color:var(--text4);text-transform:uppercase;letter-spacing:.5px}

/* Message cards */
.msg-card{background:var(--bg2);border:1px solid var(--card-border);border-radius:14px;margin-bottom:14px;overflow:hidden;animation:slideUp .4s ease}
.msg-header{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px solid rgba(100,116,139,0.08)}
.msg-header .tag{font-size:10px;font-weight:700;padding:4px 10px;border-radius:6px;letter-spacing:.5px;text-transform:uppercase}
.tag-a{background:rgba(0,159,219,0.12);color:var(--att)}
.tag-b{background:rgba(139,92,246,0.12);color:var(--purple)}
.tag-c{background:rgba(16,185,129,0.12);color:var(--green)}
.tag-d{background:rgba(245,158,11,0.12);color:var(--yellow)}
.btn-copy{display:flex;align-items:center;gap:6px;padding:7px 14px;background:rgba(37,211,102,0.1);border:1px solid rgba(37,211,102,0.2);border-radius:8px;color:var(--wa-green);font-size:11px;font-weight:600;cursor:pointer;transition:all .15s}
.btn-copy:hover{background:rgba(37,211,102,0.18)}
.btn-copy.copied{background:var(--wa-green);color:white;border-color:var(--wa-green)}
.btn-copy svg{width:14px;height:14px}

/* WhatsApp bubble */
.wa-bubble-container{padding:18px;background:linear-gradient(135deg,#ECE5DD 0%,#D5DBDB 100%);position:relative}
.wa-bubble-container::before{content:'';position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23b0bec5' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")}
.wa-bubble{position:relative;background:var(--wa-light);border-radius:0 12px 12px 12px;padding:12px 14px;max-width:90%;font-size:13px;line-height:1.55;color:#1a1a1a;box-shadow:0 1px 3px rgba(0,0,0,0.08);white-space:pre-wrap;word-wrap:break-word}
.wa-bubble::before{content:'';position:absolute;top:0;left:-8px;border-width:0 8px 8px 0;border-style:solid;border-color:transparent var(--wa-light) transparent transparent}
.wa-time{text-align:right;font-size:10px;color:#8696a0;margin-top:4px}

/* Scenario tip */
.scenario-tip{display:flex;gap:10px;align-items:flex-start;padding:12px 16px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.15);border-radius:10px;margin-bottom:14px;animation:slideUp .3s ease}
.scenario-tip .tip-icon{font-size:16px;flex-shrink:0;margin-top:1px}
.scenario-tip .tip-text{font-size:11px;color:var(--text2);line-height:1.5}
.scenario-tip .tip-text b{color:var(--yellow)}

@keyframes slideUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

/* Responsive */
@media(max-width:860px){.layout{grid-template-columns:1fr}.panel{position:static}}

/* Tabs */
.tabs{display:flex;gap:4px;margin-bottom:20px;background:rgba(15,23,42,0.6);padding:4px;border-radius:12px;border:1px solid var(--card-border)}
.tab-btn{flex:1;padding:11px 16px;background:transparent;border:none;border-radius:9px;color:var(--text3);font-size:13px;font-weight:600;cursor:pointer;transition:all .15s;display:flex;align-items:center;justify-content:center;gap:8px}
.tab-btn.active{background:linear-gradient(135deg,var(--att),var(--att-dark));color:white;box-shadow:0 4px 15px rgba(0,159,219,0.25)}
.tab-btn:hover:not(.active){background:rgba(0,159,219,0.06);color:var(--text2)}
.tab-btn svg{width:16px;height:16px}
.tab-content{display:none}.tab-content.active{display:block}

/* Mass panel adjustments */
.mass-layout{display:grid;grid-template-columns:380px 1fr;gap:24px;align-items:start}
.mass-info{display:flex;gap:10px;align-items:flex-start;padding:12px 14px;background:rgba(0,159,219,0.06);border:1px solid rgba(0,159,219,0.12);border-radius:10px;margin-bottom:16px}
.mass-info .info-icon{font-size:16px;flex-shrink:0}
.mass-info .info-text{font-size:11px;color:var(--text2);line-height:1.5}
.mass-info .info-text b{color:var(--att)}
.mass-scenario-btn{display:flex;align-items:center;gap:10px;width:100%;padding:11px 14px;background:rgba(30,41,59,0.4);border:1px solid rgba(100,116,139,0.15);border-radius:10px;color:var(--text2);font-size:13px;font-weight:500;cursor:pointer;transition:all .15s;text-align:left;margin-bottom:6px}
.mass-scenario-btn:hover{background:rgba(0,159,219,0.06);border-color:rgba(0,159,219,0.2)}
.mass-scenario-btn.active{background:rgba(0,159,219,0.1);border-color:rgba(0,159,219,0.3);color:var(--att);font-weight:600}
.mass-scenario-btn .emoji{font-size:16px;width:24px;text-align:center;flex-shrink:0}

/* Toast */
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--wa-green);color:white;padding:12px 24px;border-radius:12px;font-size:13px;font-weight:600;z-index:100;transition:transform .3s ease;box-shadow:0 8px 30px rgba(37,211,102,0.3);display:flex;align-items:center;gap:8px}
.toast.show{transform:translateX(-50%) translateY(0)}
.toast svg{width:16px;height:16px}
</style>
</head>
<body>

<div class="app">
  <!-- Header -->
  <div class="header">
    <div class="brand">
      <div class="brand-icon">
        <svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <div class="brand-text">
        <div class="label">ExpertCell</div>
        <h1>Generador de Mensajes WhatsApp</h1>
      </div>
    </div>
    <div class="agent-badge">
      <div class="dot"></div>
      <span>Agente conectado</span>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('personal')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
      Personalizado
    </button>
    <button class="tab-btn" onclick="switchTab('masivo')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
      Masivo
    </button>
    <button class="tab-btn" onclick="switchTab('renovacion')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
      Renovaci&oacute;n Premium
    </button>
  </div>

  <!-- TAB 1: Personalizado -->
  <div class="tab-content active" id="tab-personal">
  <!-- Layout -->
  <div class="layout">
    <!-- Input Panel -->
    <div class="panel">
      <div class="panel-title">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
        Datos del Cliente
      </div>
      <div class="panel-sub">Ingresa la informacion del cliente para generar mensajes personalizados</div>

      <div class="field">
        <label>Nombre del cliente</label>
        <input type="text" id="clientName" placeholder="Ej. Juan Perez">
      </div>
      <div class="field">
        <label>Plan anterior del cliente</label>
        <select id="planAnterior">
          <option value="">Seleccionar plan...</option>
          <optgroup label="Con Todo (Nextel/Iusacell)">
            <option value="Con Todo 399">Con Todo 399 ‚Äî $434/mes ‚Äî 2 GB</option>
            <option value="Con Todo 499">Con Todo 499 ‚Äî $534/mes ‚Äî 3 GB</option>
            <option value="Con Todo 549">Con Todo 549 ‚Äî $584/mes ‚Äî 5 GB</option>
            <option value="Con Todo 599">Con Todo 599 ‚Äî $634/mes ‚Äî 6 GB</option>
            <option value="Con Todo 699">Con Todo 699 ‚Äî $744/mes ‚Äî 6 GB</option>
            <option value="Con Todo 799">Con Todo 799 ‚Äî $844/mes ‚Äî 8 GB</option>
            <option value="Con Todo 999">Con Todo 999 ‚Äî $1,044/mes ‚Äî 10 GB</option>
          </optgroup>
          <optgroup label="Consiguelo">
            <option value="Consiguelo 1">Consiguelo 1 ‚Äî $309/mes ‚Äî 1 GB</option>
              <option value="Consiguelo 1.5">Consiguelo 1.5 ‚Äî $353/mes ‚Äî 1.5 GB</option>
              <option value="Consiguelo 2">Consiguelo 2 ‚Äî $404/mes ‚Äî 2 GB</option>
            <option value="Consiguelo 3">Consiguelo 3 ‚Äî $541/mes ‚Äî 3 GB</option>
            <option value="Consiguelo 5">Consiguelo 5 ‚Äî $667/mes ‚Äî 5 GB</option>
            <option value="Consiguelo 6.5">Consiguelo 6.5 ‚Äî $772/mes ‚Äî 6.5 GB</option>
            <option value="Consiguelo 8">Consiguelo 8 ‚Äî $887/mes ‚Äî 8 GB</option>
            <option value="Consiguelo 10">Consiguelo 10 ‚Äî $992/mes ‚Äî 10 GB</option>
            <option value="Consiguelo 13">Consiguelo 13 ‚Äî $1,202/mes ‚Äî 13 GB</option>
            <option value="Consiguelo 20">Consiguelo 20 ‚Äî $1,853/mes ‚Äî 20 GB</option>
          </optgroup>
          <optgroup label="Armalo">
            <option value="Armalo 3">Armalo 3 ‚Äî $325/mes ‚Äî 3 GB</option>
              <option value="Armalo 5">Armalo 5 ‚Äî $419/mes ‚Äî 5 GB</option>
            <option value="Armalo 8">Armalo 8 ‚Äî $524/mes ‚Äî 8 GB</option>
            <option value="Armalo 9">Armalo 9 ‚Äî $629/mes ‚Äî 9 GB</option>
            <option value="Armalo 10">Armalo 10 ‚Äî $629/mes ‚Äî 10 GB</option>
            <option value="Armalo 11">Armalo 11 ‚Äî $681/mes ‚Äî 11 GB</option>
            <option value="Armalo 12">Armalo 12 ‚Äî $681/mes ‚Äî 12 GB</option>
            <option value="Armalo 14">Armalo 14 ‚Äî $786/mes ‚Äî 14 GB</option>
            <option value="Armalo 17">Armalo 17 ‚Äî $891/mes ‚Äî 17 GB</option>
            <option value="Armalo 20">Armalo 20 ‚Äî $996/mes ‚Äî 20 GB</option>
            <option value="Armalo 26">Armalo 26 ‚Äî $1,101/mes ‚Äî 26 GB</option>
            <option value="Armalo 40">Armalo 40 ‚Äî $1,574/mes ‚Äî 40 GB</option>
          </optgroup>
        </select>
      </div>
      <div class="field">
        <label>Renta mensual actual (si difiere del estandar)</label>
        <input type="text" id="rentaOverride" placeholder="Dejar vacio para usar la renta del plan">
      </div>
      <div class="field">
        <label>Plan Premium a ofrecer</label>
        <select id="premiumPlan">
          <option value="auto">ü§ñ Automatico (mejor opcion segun precio)</option>
          <option value="AT&T Azul 2">AT&T Azul 2 ‚Äî $419/mes ‚Äî 8 GB</option>
          <option value="AT&T Azul 3">AT&T Azul 3 ‚Äî $529/mes ‚Äî 12 GB</option>
          <option value="AT&T Plata">AT&T Plata ‚Äî $629/mes ‚Äî 25 GB</option>
          <option value="AT&T Oro">AT&T Oro ‚Äî $699/mes ‚Äî 30 GB</option>
          <option value="AT&T Black">AT&T Black ‚Äî $799/mes ‚Äî 40 GB</option>
          <option value="AT&T Platino">AT&T Platino ‚Äî $999/mes ‚Äî 45 GB</option>
          <option value="AT&T Diamante">AT&T Diamante ‚Äî $1,259/mes ‚Äî 50 GB</option>
            <option value="AT&T Titanio">AT&T Titanio ‚Äî $1,499/mes ‚Äî 40 GB</option>
        </select>
        <div id="premium-hint" style="font-size:10px;color:var(--text4);margin-top:4px"></div>
      </div>
      <div class="field">
        <label>Tu nombre (agente)</label>
        <input type="text" id="agentName" placeholder="Ej. Carlos">
      </div>

      <div class="scenario-label">Escenario del mensaje</div>
      <div class="scenarios">
        <button class="scenario-btn active" data-scenario="primer_contacto" onclick="selectScenario(this)">
          <span class="emoji">üëã</span> Primer contacto <span class="count">4 msgs</span>
        </button>
        <button class="scenario-btn" data-scenario="seguimiento" onclick="selectScenario(this)">
          <span class="emoji">üîÑ</span> Seguimiento (no contesto) <span class="count">4 msgs</span>
        </button>
        <button class="scenario-btn" data-scenario="cierre" onclick="selectScenario(this)">
          <span class="emoji">üî•</span> Cierre / urgencia <span class="count">4 msgs</span>
        </button>
        <button class="scenario-btn" data-scenario="tienda" onclick="selectScenario(this)">
          <span class="emoji">üè™</span> Prefiere ir a tienda <span class="count">4 msgs</span>
        </button>
      </div>

      <button class="btn-generate" id="btnGenerate" onclick="generateMessages()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        Generar Mensajes de WhatsApp
      </button>
    </div>

    <!-- Results -->
    <div class="results" id="results">
      <div class="results-empty">
        <div class="icon">
          <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        </div>
        <h3>Genera mensajes poderosos</h3>
        <p>Ingresa los datos del cliente, selecciona el escenario y presiona generar. Tendras 2 opciones listas para copiar y enviar por WhatsApp.</p>
      </div>
    </div>
  </div>
  </div><!-- end tab-personal -->

  <!-- TAB 2: Masivo -->
  <div class="tab-content" id="tab-masivo">
    <div class="mass-layout">
      <!-- Mass Input Panel -->
      <div class="panel">
        <div class="panel-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          Mensaje Masivo
        </div>
        <div class="panel-sub">Genera mensajes genericos para enviar a un grupo de clientes con el mismo plan</div>

        <div class="mass-info">
          <div class="info-icon">üì¢</div>
          <div class="info-text"><b>Sin nombre del cliente.</b> Estos mensajes usan "Hola, buenas tardes" en lugar de un nombre especifico. Ideales para lanzar a listas de 50-500 numeros a la vez.</div>
        </div>

        <div class="field">
          <label>Plan anterior del grupo</label>
          <select id="massPlan">
            <option value="">Seleccionar plan...</option>
            <optgroup label="Con Todo (Nextel/Iusacell)">
              <option value="Con Todo 399">Con Todo 399 ‚Äî $434/mes ‚Äî 2 GB</option>
              <option value="Con Todo 499">Con Todo 499 ‚Äî $534/mes ‚Äî 3 GB</option>
              <option value="Con Todo 549">Con Todo 549 ‚Äî $584/mes ‚Äî 5 GB</option>
              <option value="Con Todo 599">Con Todo 599 ‚Äî $634/mes ‚Äî 6 GB</option>
              <option value="Con Todo 699">Con Todo 699 ‚Äî $744/mes ‚Äî 6 GB</option>
              <option value="Con Todo 799">Con Todo 799 ‚Äî $844/mes ‚Äî 8 GB</option>
              <option value="Con Todo 999">Con Todo 999 ‚Äî $1,044/mes ‚Äî 10 GB</option>
            </optgroup>
            <optgroup label="Consiguelo">
              <option value="Consiguelo 1">Consiguelo 1 ‚Äî $309/mes ‚Äî 1 GB</option>
              <option value="Consiguelo 1.5">Consiguelo 1.5 ‚Äî $353/mes ‚Äî 1.5 GB</option>
              <option value="Consiguelo 2">Consiguelo 2 ‚Äî $404/mes ‚Äî 2 GB</option>
              <option value="Consiguelo 3">Consiguelo 3 ‚Äî $541/mes ‚Äî 3 GB</option>
              <option value="Consiguelo 5">Consiguelo 5 ‚Äî $667/mes ‚Äî 5 GB</option>
              <option value="Consiguelo 6.5">Consiguelo 6.5 ‚Äî $772/mes ‚Äî 6.5 GB</option>
              <option value="Consiguelo 8">Consiguelo 8 ‚Äî $887/mes ‚Äî 8 GB</option>
              <option value="Consiguelo 10">Consiguelo 10 ‚Äî $992/mes ‚Äî 10 GB</option>
              <option value="Consiguelo 13">Consiguelo 13 ‚Äî $1,202/mes ‚Äî 13 GB</option>
              <option value="Consiguelo 20">Consiguelo 20 ‚Äî $1,853/mes ‚Äî 20 GB</option>
            </optgroup>
            <optgroup label="Armalo">
              <option value="Armalo 3">Armalo 3 ‚Äî $325/mes ‚Äî 3 GB</option>
              <option value="Armalo 5">Armalo 5 ‚Äî $419/mes ‚Äî 5 GB</option>
              <option value="Armalo 8">Armalo 8 ‚Äî $524/mes ‚Äî 8 GB</option>
              <option value="Armalo 9">Armalo 9 ‚Äî $629/mes ‚Äî 9 GB</option>
              <option value="Armalo 10">Armalo 10 ‚Äî $629/mes ‚Äî 10 GB</option>
              <option value="Armalo 11">Armalo 11 ‚Äî $681/mes ‚Äî 11 GB</option>
              <option value="Armalo 12">Armalo 12 ‚Äî $681/mes ‚Äî 12 GB</option>
              <option value="Armalo 14">Armalo 14 ‚Äî $786/mes ‚Äî 14 GB</option>
              <option value="Armalo 17">Armalo 17 ‚Äî $891/mes ‚Äî 17 GB</option>
              <option value="Armalo 20">Armalo 20 ‚Äî $996/mes ‚Äî 20 GB</option>
              <option value="Armalo 26">Armalo 26 ‚Äî $1,101/mes ‚Äî 26 GB</option>
              <option value="Armalo 40">Armalo 40 ‚Äî $1,574/mes ‚Äî 40 GB</option>
            </optgroup>
          </select>
        </div>
        <div class="field">
          <label>Plan Premium a ofrecer</label>
          <select id="massPremium">
            <option value="auto">ü§ñ Automatico (mejor opcion)</option>
            <option value="AT&T Azul 2">AT&T Azul 2 ‚Äî $419/mes ‚Äî 8 GB</option>
            <option value="AT&T Azul 3">AT&T Azul 3 ‚Äî $529/mes ‚Äî 12 GB</option>
            <option value="AT&T Plata">AT&T Plata ‚Äî $629/mes ‚Äî 25 GB</option>
            <option value="AT&T Oro">AT&T Oro ‚Äî $699/mes ‚Äî 30 GB</option>
            <option value="AT&T Black">AT&T Black ‚Äî $799/mes ‚Äî 40 GB</option>
            <option value="AT&T Platino">AT&T Platino ‚Äî $999/mes ‚Äî 45 GB</option>
            <option value="AT&T Diamante">AT&T Diamante ‚Äî $1,259/mes ‚Äî 50 GB</option>
            <option value="AT&T Titanio">AT&T Titanio ‚Äî $1,499/mes ‚Äî 40 GB</option>
          </select>
          <div id="mass-premium-hint" style="font-size:10px;color:var(--text4);margin-top:4px"></div>
        </div>

        <div class="scenario-label" style="font-size:11px;font-weight:600;color:var(--text3);letter-spacing:.5px;text-transform:uppercase;margin-bottom:8px;margin-top:16px">Tipo de mensaje masivo</div>
        <button class="mass-scenario-btn active" data-mass-scenario="captacion" onclick="selectMassScenario(this)">
          <span class="emoji">üëã</span> Captacion (primer contacto) <span class="count" style="margin-left:auto;font-size:10px;color:var(--text4);background:rgba(100,116,139,0.15);padding:2px 7px;border-radius:10px">4 msgs</span>
        </button>
        <button class="mass-scenario-btn" data-mass-scenario="seguimiento" onclick="selectMassScenario(this)">
          <span class="emoji">üîÑ</span> Seguimiento (2do intento) <span class="count" style="margin-left:auto;font-size:10px;color:var(--text4);background:rgba(100,116,139,0.15);padding:2px 7px;border-radius:10px">4 msgs</span>
        </button>
        <button class="mass-scenario-btn" data-mass-scenario="urgencia" onclick="selectMassScenario(this)">
          <span class="emoji">üî•</span> Urgencia / ultima oportunidad <span class="count" style="margin-left:auto;font-size:10px;color:var(--text4);background:rgba(100,116,139,0.15);padding:2px 7px;border-radius:10px">4 msgs</span>
        </button>
        <button class="mass-scenario-btn" data-mass-scenario="beneficios" onclick="selectMassScenario(this)">
          <span class="emoji">‚≠ê</span> Solo beneficios (sin precio) <span class="count" style="margin-left:auto;font-size:10px;color:var(--text4);background:rgba(100,116,139,0.15);padding:2px 7px;border-radius:10px">4 msgs</span>
        </button>

        <button class="btn-generate" onclick="generateMassMessages()" style="background:linear-gradient(135deg,#8B5CF6,#6D28D9)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          Generar Mensaje Masivo
        </button>
      </div>

      <!-- Mass Results -->
      <div class="results" id="mass-results">
        <div class="results-empty">
          <div class="icon" style="background:rgba(139,92,246,0.08)">
            <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" style="stroke:var(--purple)"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          </div>
          <h3>Mensajes para envio masivo</h3>
          <p>Selecciona el plan del grupo de clientes, elige el tipo de mensaje y genera. Mensajes sin nombre, listos para lanzar a toda una lista.</p>
        </div>
      </div>
    </div>
  </div><!-- end tab-masivo -->

  <!-- TAB 3: Renovacion Premium -->
  <div class="tab-content" id="tab-renovacion">
    <div class="mass-layout">
      <div class="panel">
        <div class="panel-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
          Renovaci&oacute;n de Plan Premium
        </div>
        <div class="panel-sub">Para clientes que YA tienen plan Premium y renuevan para obtener equipo</div>

        <div class="mass-info" style="background:rgba(139,92,246,0.06);border-color:rgba(139,92,246,0.12)">
          <div class="info-icon">üíé</div>
          <div class="info-text"><b>Cliente Premium existente.</b> El plan se mantiene igual, el beneficio es el equipo: sin costo o financiado con descuentos.</div>
        </div>

        <div class="field">
          <label>Nombre del cliente (dejar vacio para masivo)</label>
          <input type="text" id="renName" placeholder="Ej. Juan Perez (opcional)">
        </div>
        <div class="field">
          <label>Plan Premium actual del cliente</label>
          <select id="renPlan">
            <option value="">Seleccionar plan Premium...</option>
            <option value="AT&T Azul 2">AT&T Azul 2 &mdash; $419/mes &mdash; 8 GB</option>
            <option value="AT&T Azul 3">AT&T Azul 3 &mdash; $529/mes &mdash; 12 GB</option>
            <option value="AT&T Plata">AT&T Plata &mdash; $629/mes &mdash; 25 GB</option>
            <option value="AT&T Oro">AT&T Oro &mdash; $699/mes &mdash; 30 GB</option>
            <option value="AT&T Black">AT&T Black &mdash; $799/mes &mdash; 40 GB</option>
            <option value="AT&T Platino">AT&T Platino &mdash; $999/mes &mdash; 45 GB</option>
            <option value="AT&T Diamante">AT&T Diamante &mdash; $1,259/mes &mdash; 50 GB</option>
            <option value="AT&T Titanio">AT&T Titanio ‚Äî $1,499/mes ‚Äî 40 GB</option>
          </select>
        </div>
        <div class="field">
          <label>Tu nombre (agente)</label>
          <input type="text" id="renAgent" placeholder="Ej. Carlos (opcional)">
        </div>

        <div class="scenario-label" style="font-size:11px;font-weight:600;color:var(--text3);letter-spacing:.5px;text-transform:uppercase;margin-bottom:8px;margin-top:16px">Tipo de mensaje</div>
        <button class="mass-scenario-btn active" data-ren-scenario="primer_contacto" onclick="selectRenScenario(this)">
          <span class="emoji">üëã</span> Primer contacto
        </button>
        <button class="mass-scenario-btn" data-ren-scenario="seguimiento" onclick="selectRenScenario(this)">
          <span class="emoji">üîÑ</span> Seguimiento
        </button>
        <button class="mass-scenario-btn" data-ren-scenario="equipo" onclick="selectRenScenario(this)">
          <span class="emoji">üì±</span> Enfocado en equipo
        </button>
        <button class="mass-scenario-btn" data-ren-scenario="urgencia" onclick="selectRenScenario(this)">
          <span class="emoji">üî•</span> Urgencia / cierre
        </button>

        <button class="btn-generate" onclick="generateRenMessages()" style="background:linear-gradient(135deg,#8B5CF6,#6D28D9)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/></svg>
          Generar Mensaje de Renovaci&oacute;n
        </button>
      </div>

      <!-- Renovation Results -->
      <div class="results" id="ren-results">
        <div class="results-empty">
          <div class="icon" style="background:rgba(139,92,246,0.08)">
            <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" style="stroke:var(--purple)"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
          </div>
          <h3>Renovaciones Premium</h3>
          <p>Para clientes que ya tienen plan Premium. Genera mensajes enfocados en el equipo sin costo o con descuento al renovar.</p>
        </div>
      </div>
    </div>
  </div><!-- end tab-renovacion -->

</div>

<!-- Toast -->
<div class="toast" id="toast">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
  Mensaje copiado al portapapeles
</div>

<script>
// ================================================================
// PLAN DATABASE - Safari iOS compatible (no template literals)
// ================================================================
var PLANS = {
  "Con Todo 399": {renta:434,gb:2,type:"contodo"},
  "Con Todo 499": {renta:534,gb:3,type:"contodo"},
  "Con Todo 549": {renta:584,gb:5,type:"contodo"},
  "Con Todo 599": {renta:634,gb:6,type:"contodo"},
  "Con Todo 699": {renta:744,gb:6,type:"contodo"},
  "Con Todo 799": {renta:844,gb:8,type:"contodo"},
  "Con Todo 999": {renta:1044,gb:10,type:"contodo"},
  "Consiguelo 2": {renta:404,gb:2,type:"consiguelo"},
  "Consiguelo 3": {renta:541,gb:3,type:"consiguelo"},
  "Consiguelo 5": {renta:667,gb:5,type:"consiguelo"},
  "Consiguelo 6.5":{renta:772,gb:6.5,type:"consiguelo"},
  "Consiguelo 8": {renta:887,gb:8,type:"consiguelo"},
  "Consiguelo 10": {renta:992,gb:10,type:"consiguelo"},
  "Consiguelo 13": {renta:1202,gb:13,type:"consiguelo"},
  "Consiguelo 20": {renta:1853,gb:20,type:"consiguelo"},
  "Armalo 3":  {renta:325,gb:3,type:"armalo"},
  "Armalo 5":  {renta:419,gb:5,type:"armalo"},
  "Armalo 8":  {renta:524,gb:8,type:"armalo"},
  "Armalo 9":  {renta:629,gb:9,type:"armalo"},
  "Armalo 10": {renta:629,gb:10,type:"armalo"},
  "Armalo 11": {renta:681,gb:11,type:"armalo"},
  "Armalo 12": {renta:681,gb:12,type:"armalo"},
  "Armalo 14": {renta:786,gb:14,type:"armalo"},
  "Armalo 17": {renta:891,gb:17,type:"armalo"},
  "Armalo 20": {renta:996,gb:20,type:"armalo"},
  "Armalo 26": {renta:1101,gb:26,type:"armalo"},
  "Armalo 40": {renta:1574,gb:40,type:"armalo"}
};

var PREMIUM = {
  "AT&T Azul 2": {renta:419,gb:8},
  "AT&T Azul 3": {renta:529,gb:12},
  "AT&T Plata":  {renta:629,gb:25},
  "AT&T Oro":    {renta:699,gb:30},
  "AT&T Black":  {renta:799,gb:40},
  "AT&T Platino": {renta:999,gb:45},
  "AT&T Diamante":{renta:1259,gb:50},
  "AT&T Titanio": {renta:1499,gb:40}
};

function findBestPremium(renta, gb) {
  var candidates = [];
  var keys = Object.keys(PREMIUM);
  for (var k = 0; k < keys.length; k++) {
    var name = keys[k];
    var p = PREMIUM[name];
    if (p.gb > gb) {
      candidates.push({name:name, renta:p.renta, gb:p.gb, saving:renta-p.renta, gbGain:p.gb-gb, gbMultiple:(p.gb/gb).toFixed(1)});
    }
  }
  if (candidates.length > 0) {
    candidates.sort(function(a,b) {
      var aOK = a.saving >= -50 ? 1 : 0;
      var bOK = b.saving >= -50 ? 1 : 0;
      if (aOK !== bOK) return bOK - aOK;
      return (b.saving*1.5+b.gbGain*5) - (a.saving*1.5+a.gbGain*5);
    });
    return candidates[0];
  }
  var closest = null, closestDiff = 999999;
  for (var k = 0; k < keys.length; k++) {
    var name = keys[k], p = PREMIUM[name];
    var diff = Math.abs(p.renta - renta);
    if (diff < closestDiff) {
      closestDiff = diff;
      closest = {name:name, renta:p.renta, gb:p.gb, saving:renta-p.renta, gbGain:p.gb-gb, gbMultiple:(p.gb/Math.max(gb,1)).toFixed(1)};
    }
  }
  return closest;
}

// ================================================================
// STATE
// ================================================================
var selectedScenario = "primer_contacto";
var selectedMassScenario = "captacion";

function selectScenario(btn) {
  var btns = document.querySelectorAll(".scenario-btn");
  for (var i=0;i<btns.length;i++) btns[i].classList.remove("active");
  btn.classList.add("active");
  selectedScenario = btn.getAttribute("data-scenario");
}
function selectMassScenario(btn) {
  var btns = document.querySelectorAll(".mass-scenario-btn");
  for (var i=0;i<btns.length;i++) btns[i].classList.remove("active");
  btn.classList.add("active");
  selectedMassScenario = btn.getAttribute("data-mass-scenario");
}

// ================================================================
// HELPER: build message line by line (Safari safe)
// ================================================================
function L() {
  // Join all arguments with newline
  var parts = [];
  for (var i = 0; i < arguments.length; i++) parts.push(arguments[i]);
  return parts.join("\n");
}

// ================================================================
// PRE-COMPUTE phrases from data
// ================================================================
function makeCtx(planName, planType, renta, gb, premium, firstName, agent) {
  var c = {};
  c.planName = planName;
  c.planType = planType;
  c.renta = renta;
  c.gb = gb;
  c.pName = premium.name;
  c.pRenta = premium.renta;
  c.pGb = premium.gb;
  c.saving = premium.saving;
  c.gbMult = premium.gbMultiple;
  c.savingYear = Math.abs(premium.saving) * 12;
  c.saves = premium.saving > 0;
  c.same = premium.saving === 0;
  c.firstName = firstName || "";
  c.agent = agent || "tu asesor";
  c.planLabel = planType === "contodo" ? "Con Todo" : planType === "consiguelo" ? "Consiguelo" : "Armalo";
  
  // Pre-build conditional phrases
  c.pagarias = c.saves ? "pagando *$" + c.saving + " menos*" : c.same ? "pagando *lo mismo*" : "por *solo $" + Math.abs(c.saving) + " mas*";
  c.tarifaFrase = c.saves ? "bajara a tan solo *$" + c.pRenta + " al mes*" : c.same ? "se mantiene en *$" + c.pRenta + " al mes*" : "sera de *$" + c.pRenta + " al mes*";
  c.tarifaBajo = c.saves ? "bajo a tan solo $" + c.pRenta : "sera de tan solo $" + c.pRenta;
  c.incremento = c.saves ? "incremento" : "tendras";
  c.sabias = c.saves ? "Sabias que hoy pagas *$" + renta + "* por tu plan y podrias pagar *$" + c.pRenta + "* con *" + c.pGb + " GB* y apps ilimitadas?" : "Sabias que por " + (c.same ? "lo que ya pagas" : "casi lo mismo") + " podrias tener *" + c.pGb + " GB* en lugar de *" + gb + " GB* mas apps ilimitadas y llamadas a EUA y Canada?";
  c.ahorroMes = c.saves ? "y *ahorras $" + c.saving + " al mes* ($" + c.savingYear + " al a\u00f1o)" : "por practicamente el mismo precio";
  c.ahorroMes2 = c.saves ? "y pagas *menos* ($" + c.pRenta + " en lugar de $" + renta + ")" : "por " + (c.same ? "el mismo precio" : "solo $" + Math.abs(c.saving) + " mas");
  c.sonAhorro = c.saves ? "Son *$" + c.savingYear + " de ahorro al a\u00f1o* \ud83d\udcb0" : "Es " + c.gbMult + "x mas datos por practicamente lo mismo";
  c.ahorrandoFrase = c.saves ? "ahorrando *$" + c.saving + "/mes*" : "sin pagar mas";
  c.precioCompare = c.saves ? " (*ahorras $" + c.saving + "/mes*)" : "";
  c.tarifaMasBaja = c.saves ? "mas baja: *$" + c.pRenta + "/mes* (hoy pagas $" + renta + ")" : "de *$" + c.pRenta + "/mes*";
  c.ahorroLinea = c.saves ? "-Ahorrarias *$" + c.saving + "/mes* ($" + c.savingYear + " al a\u00f1o)" : "-Tu tarifa seria de *$" + c.pRenta + "/mes*";
  c.masivo_ahorro = c.saves ? "pagando *menos* ($" + c.pRenta + " en vez de $" + renta + ")" : "por " + (c.same ? "el mismo precio" : "casi lo mismo");
  c.masivo_seg_ahorro = c.saves ? "y *ahorras $" + c.saving + " al mes* ($" + c.savingYear + " al a\u00f1o \ud83d\udcb0)" : "por " + (c.same ? "el mismo precio" : "practicamente lo mismo");
  
  return c;
}

// ================================================================
// PERSONAL TEMPLATES
// ================================================================
function getMessages(data) {
  var c = makeCtx(data.planName, data.planType, data.renta, data.gb, data.premium, data.name ? data.name.split(" ")[0] : "", data.agent);

  var templates = {
    primer_contacto: {
      tip: "<b>Tip:</b> El primer contacto debe ser corto y generar curiosidad. No satures con informacion. El objetivo es que responda \"si\" para poder llamarle.",
      messages: [
        { tag: "Opcion A \u2014 Directo con comparacion",
          text: L("Hola " + c.firstName + ", buenas tardes \ud83d\udc4b Te saluda " + c.agent + " de AT&T.", "",
            "Revisando tu linea veo que sigues con un plan " + c.planName + " y hoy pagas $" + c.renta + "/mes por " + c.gb + " GB.", "",
            "Tengo una buena noticia: ya puedes actualizar a *" + c.pName + "* " + c.pagarias + " y recibes:", "",
            "\u2705 *" + c.pGb + " GB* de navegacion (" + c.gbMult + "x mas que hoy)",
            "\u2705 6 apps ilimitadas",
            "\u2705 Llamadas y mensajes a EUA y Canada", "",
            "Conservas tu mismo numero y no tienes que ir a ninguna tienda. Te interesa? Solo toma 5 minutos \ud83d\udcf2") },
        { tag: "Opcion B \u2014 Corto y con gancho",
          text: L("Hola " + c.firstName + " \ud83d\udc4b Te contacto de AT&T.", "",
            c.sabias, "",
            "Tu plan " + c.planName + " ya puede actualizarse y la mejora es importante.", "",
            "Quieres que te explique en 2 minutos? \ud83d\udcf1") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("Hola " + c.firstName + "!\ud83d\udc4b",
            "Tu plan *" + c.planName + "* ya cumplio su vigencia y tienes disponible una actualizacion a los planes *Premium*\ud83d\udc8e",
            "La diferencia principal es que con la actualizacion:",
            "-Recibiras *" + c.pGb + " GB* (" + c.gbMult + "x mas de lo que tienes hoy)",
            "-Tu tarifa " + c.tarifaFrase,
            "-Podras adquirir el equipo que desees con descuentos increibles o bien si no deseas gastar simplemente reclama el equipo sin costo que te pertenece como cliente",
            "-Mas apps ilimitadas",
            "-Llamadas y mensajes a EUA y Canada", "",
            "Con esta propuesta AT&T quiere darte lo mejor y por ello tu respuesta es valiosa para mejorar, responde:",
            "1)\ud83d\udcb0Obviamente quiero pagar menos\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa cotizar un equipo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante\ud83d\udea8", "",
            "Hola " + c.firstName + ", es hora de actualizar tu plan ya que *tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "Tu respuesta es importante para nosotros, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    },
    seguimiento: {
      tip: "<b>Tip:</b> Si no contesto el primer mensaje, cambia el enfoque. Genera urgencia o curiosidad con un dato diferente. No reenvies el mismo mensaje.",
      messages: [
        { tag: "Opcion A \u2014 Dato de impacto",
          text: L(c.firstName + ", te escribi hace unos dias sobre la mejora de tu plan AT&T.", "",
            "Solo para que lo tengas claro: con tu plan actual pagas *$" + c.renta + "/mes* por *" + c.gb + " GB*. Con la actualizacion tendrias *" + c.pGb + " GB* " + c.ahorroMes + ".", "",
            "La promocion sigue disponible, pero no por mucho tiempo \u23f3", "",
            "Te interesa? Respondeme y lo armamos rapido.") },
        { tag: "Opcion B \u2014 Ultra breve",
          text: L(c.firstName + " \ud83d\udc4b Tu mejora de plan AT&T sigue disponible.", "",
            "De *" + c.gb + " GB* pasas a *" + c.pGb + " GB* " + c.ahorroMes2 + ".", "",
            "Respondeme *SI* y te explico en 1 minuto \u2705") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("Hola de nuevo " + c.firstName + "!\ud83d\udc4b",
            "Te contactamos de AT&T porque tu plan *" + c.planName + "* tiene una actualizacion *Premium* disponible\ud83d\udc8e", "",
            "Mira lo que incluye:",
            "-*" + c.pGb + " GB* de navegacion (" + c.gbMult + "x mas que tu plan actual)",
            "-Tarifa " + c.tarifaMasBaja,
            "-Acceso a descuentos en equipos o equipo sin costo",
            "-Apps ilimitadas + llamadas a EUA y Canada", "",
            "No queremos que te quedes sin esta mejora, respondenos:",
            "1)\ud83d\udcb0Quiero pagar menos y mejorar mi plan\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa cotizar un equipo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante\ud83d\udea8", "",
            c.firstName + ", te recordamos que tu plan *" + c.planName + "* ya tiene disponible una mejora: *tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "Tu respuesta es importante para nosotros, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    },
    cierre: {
      tip: "<b>Tip:</b> El mensaje de cierre debe crear urgencia real. Usa fechas, numeros concretos y haz que la accion sea facil.",
      messages: [
        { tag: "Opcion A \u2014 Urgencia con fecha",
          text: L(c.firstName + ", te comento que la promocion para actualizar tu plan " + c.planName + " esta por vencer este mes.", "",
            "Mira lo que pierdes si no actualizas:", "",
            "\u274c Tu plan actual: " + c.gb + " GB + solo redes sociales \u2014 *$" + c.renta + "/mes*",
            "\u2705 Plan " + c.pName + ": *" + c.pGb + " GB* + 6 apps ilimitadas + llamadas a EUA/Canada \u2014 *$" + c.pRenta + "/mes*", "",
            c.sonAhorro, "",
            "Despues de este mes, tu linea se queda con el plan anterior sin posibilidad de mejora en las mismas condiciones.", "",
            "Lo activamos? Te llamo en 2 minutos si me respondes *SI* \u2705") },
        { tag: "Opcion B \u2014 Social proof + facilidad",
          text: L(c.firstName + ", esta semana ya ayudamos a muchos clientes AT&T con plan " + c.planLabel + " a mejorar su servicio.", "",
            "La mayoria paso de " + c.gb + " GB a *" + c.pGb + " GB* " + c.ahorrandoFrase + ".", "",
            "Lo hacemos en 5 minutos por telefono, no tienes que ir a tienda ni hacer tramites complicados \ud83d\ude4c", "",
            "Te marco? Solo respondeme *SI* y listo.") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("\u26a0\ufe0f Ultima oportunidad " + c.firstName + "!",
            "Tu plan *" + c.planName + "* esta por perder la posibilidad de actualizar a *Premium*\ud83d\udc8e", "",
            "Lo que esta en juego:",
            "-Pasarias de *" + c.gb + " GB* a *" + c.pGb + " GB* de navegacion",
            c.ahorroLinea,
            "-Descuentos exclusivos en equipos nuevos o equipo sin costo",
            "-Apps ilimitadas + llamadas a EUA y Canada", "",
            "Responde antes de que cierre:",
            "1)\ud83d\udcb0Si! Quiero la mejora\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa un equipo nuevo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante " + c.firstName + "\ud83d\udea8", "",
            "Tu plan *" + c.planName + "* esta en sus ultimos dias para actualizar. *Tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "No dejes pasar esta oportunidad, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    },
    tienda: {
      tip: "<b>Tip:</b> El cliente que dice \"prefiero ir a tienda\" generalmente tiene desconfianza. Valida su preocupacion y muestra las ventajas de hacerlo por telefono.",
      messages: [
        { tag: "Opcion A \u2014 Validar + ventaja",
          text: L("Entiendo perfectamente " + c.firstName + " \ud83d\udc4d Es normal querer ir a la tienda.", "",
            "Solo te comento 3 ventajas de hacerlo conmigo por telefono:", "",
            "1\ufe0f\u20e3 *No haces fila* \u2014 en tienda el tiempo promedio es de 40 min a 1 hora",
            "2\ufe0f\u20e3 *Mismo resultado* \u2014 el plan " + c.pName + " con *" + c.pGb + " GB* a *$" + c.pRenta + "/mes* es exactamente el mismo",
            "3\ufe0f\u20e3 *Queda grabado* \u2014 la llamada queda registrada como respaldo de tu cambio", "",
            "Si prefieres ir a tienda no hay problema, pero si quieres ahorrarte el viaje lo hacemos ahorita en 5 minutos \ud83d\udcf2", "",
            "Tu decides \ud83e\udd1d") },
        { tag: "Opcion B \u2014 Disponibilidad + urgencia",
          text: L("Claro " + c.firstName + ", en la tienda te pueden atender sin problema.", "",
            "Solo ten en cuenta que esta promocion la estamos manejando directamente y *puede que en tienda no tengan la misma oferta*.", "",
            "Tu plan " + c.planName + " de $" + c.renta + "/mes cambiaria a *" + c.pName + "* con *" + c.pGb + " GB* a *$" + c.pRenta + "/mes*" + c.precioCompare + ".", "",
            "Si decides hacerlo por aqui, te llamo y lo resolvemos rapido. Si prefieres tienda, te recomiendo ir a la mas cercana antes de fin de mes cuando cambian las promociones.", "",
            "Como le hacemos? \ud83d\udcf1") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("Hola " + c.firstName + "!\ud83d\udc4b",
            "Entendemos que prefieras ir a tienda, es totalmente valido \ud83d\udc4d", "",
            "Pero antes de que hagas el viaje, mira lo que tu plan *" + c.planName + "* puede mejorar:",
            "-*" + c.pGb + " GB* de navegacion (" + c.gbMult + "x mas que hoy)",
            "-Tarifa " + c.tarifaMasBaja,
            "-Equipo sin costo o descuentos increibles",
            "-Apps ilimitadas + llamadas a EUA y Canada", "",
            "Todo esto lo puedes hacer por telefono en 5 minutos, sin filas. Pero tu decides:",
            "1)\ud83d\udcb0Hagamoslo por telefono, quiero la mejora\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa cotizar un equipo\ud83d\udcf1",
            "3)Prefiero ir a tienda de todos modos") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante " + c.firstName + "\ud83d\udea8", "",
            "Antes de que vayas a tienda, te compartimos que *tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "Lo mejor: lo hacemos por telefono sin que tengas que hacer fila \ud83d\ude4c", "",
            "Elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    }
  };
  return templates[selectedScenario];
}

// ================================================================
// MASS TEMPLATES
// ================================================================
function getMassMessages(planKey, renta, gb, premium) {
  var c = makeCtx(planKey, PLANS[planKey].type, renta, gb, premium, "", "");

  var templates = {
    captacion: {
      tip: "<b>Captacion masiva:</b> Mensajes cortos y directos. El objetivo es que respondan. No incluyen nombre porque van a listas completas.",
      messages: [
        { tag: "Opcion A \u2014 Con datos duros",
          text: L("Hola, buenas tardes \ud83d\udc4b Te contactamos de AT&T.", "",
            "Detectamos que tu plan *" + c.planName + "* ya puede actualizarse.", "",
            "Hoy pagas *$" + c.renta + "/mes* por *" + c.gb + " GB*. Con la actualizacion a *" + c.pName + "* " + c.pagarias + " y recibes:", "",
            "\u2705 *" + c.pGb + " GB* de navegacion (" + c.gbMult + "x mas)",
            "\u2705 6 apps ilimitadas",
            "\u2705 Llamadas a EUA y Canada", "",
            "Conservas tu numero, sin ir a tienda. Te interesa? \ud83d\udcf2") },
        { tag: "Opcion B \u2014 Corto y curioso",
          text: L("Hola \ud83d\udc4b Te escribimos de AT&T.", "",
            c.sabias, "",
            "Tu plan " + c.planName + " ya tiene actualizacion disponible \u2705", "",
            "Quieres saber mas? Respondeme SI y te explico en 2 minutos.") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("Hola!\ud83d\udc4b",
            "Tu plan *" + c.planName + "* ya cumplio su vigencia y tienes disponible una actualizacion a los planes *Premium*\ud83d\udc8e",
            "La diferencia principal es que con la actualizacion:",
            "-Recibiras *" + c.pGb + " GB* (" + c.gbMult + "x mas de lo que tienes hoy)",
            "-Tu tarifa " + c.tarifaFrase,
            "-Podras adquirir el equipo que desees con descuentos increibles o bien si no deseas gastar simplemente reclama el equipo sin costo que te pertenece como cliente",
            "-Mas apps ilimitadas",
            "-Llamadas y mensajes a EUA y Canada", "",
            "Con esta propuesta AT&T quiere darte lo mejor y por ello tu respuesta es valiosa para mejorar, responde:",
            "1)\ud83d\udcb0Obviamente quiero pagar menos\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa cotizar un equipo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante\ud83d\udea8", "",
            "Es hora de actualizar tu plan ya que *tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "Tu respuesta es importante para nosotros, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    },
    seguimiento: {
      tip: "<b>Seguimiento masivo:</b> Para listas que ya recibieron un primer mensaje y no contestaron.",
      messages: [
        { tag: "Opcion A \u2014 Recordatorio con dato",
          text: L("Hola, te escribimos hace unos dias de AT&T sobre la mejora disponible para tu plan \ud83d\udcf1", "",
            "Solo para recordarte: con tu plan *" + c.planName + "* pagas *$" + c.renta + "/mes* por *" + c.gb + " GB*.", "",
            "Con la actualizacion tendrias *" + c.pGb + " GB* " + c.masivo_seg_ahorro + ".", "",
            "La oferta sigue vigente pero tiene fecha limite \u23f3", "",
            "Respondeme SI si te interesa.") },
        { tag: "Opcion B \u2014 Muy breve",
          text: L("\ud83d\udc4b Tu mejora de plan AT&T sigue disponible.", "",
            "De *" + c.gb + " GB* a *" + c.pGb + " GB* " + c.masivo_ahorro + ".", "",
            "Responde *SI* y te explico rapido \u2705") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("Hola de nuevo!\ud83d\udc4b",
            "Te contactamos de AT&T porque tu plan *" + c.planName + "* tiene una actualizacion *Premium* disponible\ud83d\udc8e", "",
            "Mira lo que incluye:",
            "-*" + c.pGb + " GB* de navegacion (" + c.gbMult + "x mas que tu plan actual)",
            "-Tarifa " + c.tarifaMasBaja,
            "-Acceso a descuentos en equipos o equipo sin costo",
            "-Apps ilimitadas + llamadas a EUA y Canada", "",
            "No queremos que te quedes sin esta mejora, respondenos:",
            "1)\ud83d\udcb0Quiero pagar menos y mejorar mi plan\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa cotizar un equipo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante\ud83d\udea8", "",
            "Te recordamos que tu plan *" + c.planName + "* ya tiene disponible una mejora: *tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "Tu respuesta es importante para nosotros, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    },
    urgencia: {
      tip: "<b>Urgencia:</b> Ultimo intento. Usa escasez y datos concretos para motivar la accion inmediata.",
      messages: [
        { tag: "Opcion A \u2014 Ultimo aviso",
          text: L("\u26a0\ufe0f Ultimo aviso sobre tu actualizacion AT&T.", "",
            "Tu plan *" + c.planName + "* ya puede migrar a *" + c.pName + "* con mejores beneficios:", "",
            "\u274c Hoy: *" + c.gb + " GB* + redes sociales \u2014 *$" + c.renta + "/mes*",
            "\u2705 Nuevo: *" + c.pGb + " GB* + 6 apps ilimitadas + EUA/Canada \u2014 *$" + c.pRenta + "/mes*", "",
            c.sonAhorro, "",
            "Esta promocion vence pronto. Despues tu linea se queda sin posibilidad de mejora en estas condiciones.", "",
            "Responde *SI* para activarlo hoy \u2705") },
        { tag: "Opcion B \u2014 Social proof breve",
          text: L("Esta semana cientos de clientes AT&T con plan *" + c.planLabel + "* ya actualizaron su servicio \ud83d\ude80", "",
            "Pasaron de *" + c.gb + " GB* a *" + c.pGb + " GB* " + c.ahorrandoFrase + ".", "",
            "No te quedes con el plan anterior. Responde *SI* y lo activamos en 5 minutos. Sin ir a tienda \ud83d\ude4c") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("\u26a0\ufe0f Ultima oportunidad!",
            "Tu plan *" + c.planName + "* esta por perder la posibilidad de actualizar a *Premium*\ud83d\udc8e", "",
            "Lo que esta en juego:",
            "-Pasarias de *" + c.gb + " GB* a *" + c.pGb + " GB* de navegacion",
            c.ahorroLinea,
            "-Descuentos exclusivos en equipos nuevos o equipo sin costo",
            "-Apps ilimitadas + llamadas a EUA y Canada", "",
            "Esta oferta vence pronto y no podremos garantizar las mismas condiciones despues.", "",
            "Responde antes de que cierre:",
            "1)\ud83d\udcb0Si! Quiero la mejora\ud83d\udcb0",
            "2)\ud83d\udcf1Me interesa un equipo nuevo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante \u2014 Ultimo aviso\ud83d\udea8", "",
            "Tu plan *" + c.planName + "* esta en sus ultimos dias para actualizar. *Tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "No dejes pasar esta oportunidad, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    },
    beneficios: {
      tip: "<b>Solo beneficios:</b> No menciona precios. Util cuando el ahorro es minimo. Enfocate en lo que gana.",
      messages: [
        { tag: "Opcion A \u2014 Enfocado en mejoras",
          text: L("Hola \ud83d\udc4b Te contactamos de AT&T con buenas noticias.", "",
            "Tu plan *" + c.planName + "* ya tiene disponible una actualizacion con mejores beneficios:", "",
            "\u2705 Mas gigas de navegacion libre",
            "\u2705 6 apps completamente ilimitadas (WhatsApp, Facebook, Instagram, TikTok y mas)",
            "\u2705 Llamadas y mensajes ilimitados a Mexico, EUA y Canada",
            "\u2705 Conservas tu mismo numero", "",
            "Todo sin ir a tienda y en menos de 5 minutos \ud83d\udcf2", "",
            "Te gustaria conocer los detalles? Responde SI y te explico.") },
        { tag: "Opcion B \u2014 Pregunta gancho",
          text: L("Hola \ud83d\udc4b Pregunta rapida:", "",
            "Tu plan AT&T actual tiene llamadas a Estados Unidos y Canada? Y apps de streaming ilimitadas?", "",
            "Si la respuesta es no, tu plan ya puede actualizarse a uno que SI incluye todo eso \u2705", "",
            "Quieres que te cuente como funciona? Solo toma 2 minutos.") },
        { tag: "Opcion C \u2014 Interactivo con opciones",
          text: L("Hola!\ud83d\udc4b",
            "Tenemos noticias para ti de parte de AT&T\ud83d\udc8e", "",
            "Tu plan *" + c.planName + "* ya puede actualizarse a un plan *Premium* con beneficios superiores:",
            "-*" + c.pGb + " GB* de navegacion libre",
            "-6 apps completamente ilimitadas",
            "-Llamadas y mensajes a Mexico, EUA y Canada",
            "-Acceso a descuentos increibles en equipos o reclama tu equipo sin costo como cliente", "",
            "AT&T quiere darte lo mejor y por ello tu respuesta es valiosa para mejorar, responde:",
            "1)\ud83d\udcb0Me interesa mejorar mi plan\ud83d\udcb0",
            "2)\ud83d\udcf1Quiero cotizar un equipo\ud83d\udcf1",
            "3)No deseo ser contactado por este medio") },
        { tag: "Opcion D \u2014 Alerta con multiples opciones",
          text: L("\ud83d\udea8Actualizacion importante\ud83d\udea8", "",
            "Es hora de actualizar tu plan ya que *tu tarifa " + c.tarifaBajo + "* y ademas " + c.incremento + " a *" + c.pGb + " GB* libres para navegar. Adicional puedes elegir entre llevarte un dispositivo sin costo o bien elegir el equipo que gustes aprovechando nuestros descuentos en las mejores marcas.", "",
            "\ud83d\udce2\u203c\ufe0f Tambien recuerda que puedes adquirir una linea adicional sin plazo establecido si asi lo requieres \u203c\ufe0f\ud83d\udce2", "",
            "Tu respuesta es importante para nosotros, elige un numero \ud83d\udea8",
            "1)*Si quiero pagar menos*\ud83d\udcb0\ud83d\udcb0\ud83d\udcb0",
            "2)*Me gustaria cotizar \ud83e\udd11 un equipo*\ud83d\udcf2",
            "3)*Requiero una linea adicional*",
            "4)*Quiero mas informacion* \ud83e\udd29",
            "5) Deseo que no me contacten por este medio", "",
            "*AT&T cambia el juego* \ud83d\ude09") }
      ]
    }
  };
  return templates[selectedMassScenario];
}

// ================================================================
// GENERATE PERSONAL
// ================================================================
function generateMessages() {
  try {
    var name = document.getElementById("clientName").value.trim();
    var planKey = document.getElementById("planAnterior").value;
    var rentaOvr = document.getElementById("rentaOverride").value.trim();
    var agent = document.getElementById("agentName").value.trim();
    var premChoice = document.getElementById("premiumPlan").value;
    if (!name) { shake("clientName"); return; }
    if (!planKey) { shake("planAnterior"); return; }
    var plan = PLANS[planKey];
    var renta = rentaOvr ? parseInt(rentaOvr.replace(/[^0-9]/g,"")) : plan.renta;
    var premium;
    if (premChoice === "auto") { premium = findBestPremium(renta, plan.gb); }
    else { var p = PREMIUM[premChoice]; premium = {name:premChoice,renta:p.renta,gb:p.gb,saving:renta-p.renta,gbGain:p.gb-plan.gb,gbMultiple:(p.gb/plan.gb).toFixed(1)}; }
    var data = {name:name, agent:agent||"tu asesor", planName:planKey, planType:plan.type, renta:renta, gb:plan.gb, premium:premium};
    var result = getMessages(data);
    renderResults(data, result);
  } catch(e) { alert("Error: " + e.message); }
}

// ================================================================
// GENERATE MASS
// ================================================================
function generateMassMessages() {
  try {
    var planKey = document.getElementById("massPlan").value;
    var premChoice = document.getElementById("massPremium").value;
    if (!planKey) { shake("massPlan"); return; }
    var plan = PLANS[planKey];
    var renta = plan.renta, gb = plan.gb;
    var premium;
    if (premChoice === "auto") { premium = findBestPremium(renta, gb); }
    else { var p = PREMIUM[premChoice]; premium = {name:premChoice,renta:p.renta,gb:p.gb,saving:renta-p.renta,gbGain:p.gb-gb,gbMultiple:(p.gb/Math.max(gb,1)).toFixed(1)}; }
    var result = getMassMessages(planKey, renta, gb, premium);
    renderMassResults(planKey, renta, gb, premium, result);
  } catch(e) { alert("Error masivo: " + e.message); }
}

// ================================================================
// RENDER
// ================================================================
function renderResults(data, result) {
  var renta=data.renta, gb=data.gb, premium=data.premium, planName=data.planName;
  var saving=premium.saving, saves=saving>0;
  var h = "";
  h += '<div class="comparison"><div class="comparison-title">Comparativa automatica del plan</div>';
  h += '<div class="compare-grid"><div class="compare-box old"><div class="box-label">Plan Actual</div>';
  h += '<div class="plan-name">' + planName + '</div><div class="plan-price">$' + renta + '</div>';
  h += '<div class="plan-data">' + gb + ' GB + redes sociales</div></div>';
  h += '<div class="compare-arrow">\u2192</div>';
  h += '<div class="compare-box new"><div class="box-label">Plan Recomendado</div>';
  h += '<div class="plan-name">' + premium.name + '</div><div class="plan-price">$' + premium.renta + '</div>';
  h += '<div class="plan-data">' + premium.gb + ' GB + 6 apps + EUA/CAN</div></div></div>';
  h += '<div class="savings-strip">';
  h += '<div class="saving-item"><div class="val" style="color:' + (saves?"#10B981":saving===0?"#009FDB":"#F59E0B") + '">' + (saves?"-$"+saving+"/mes":saving===0?"$0":"+$"+Math.abs(saving)+"/mes") + '</div><div class="lbl">' + (saves?"Ahorro mensual":saving===0?"Mismo precio":"Diferencia") + '</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#009FDB">' + premium.gbMultiple + 'x</div><div class="lbl">Mas datos</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#10B981">' + premium.gb + ' GB</div><div class="lbl">Navegacion libre</div></div>';
  if (saves) h += '<div class="saving-item"><div class="val" style="color:#10B981">$' + (saving*12) + '/a\u00f1o</div><div class="lbl">Ahorro anual</div></div>';
  h += '</div></div>';
  h += '<div class="scenario-tip"><div class="tip-icon">\ud83d\udca1</div><div class="tip-text">' + result.tip + '</div></div>';
  var tags = ["tag-a","tag-b","tag-c","tag-d"];
  var now = new Date();
  var timeStr = ("0"+now.getHours()).slice(-2) + ":" + ("0"+now.getMinutes()).slice(-2);
  for (var i = 0; i < result.messages.length; i++) {
    var msg = result.messages[i];
    h += '<div class="msg-card"><div class="msg-header"><span class="tag ' + tags[i] + '">' + msg.tag + '</span>';
    h += '<button class="btn-copy" onclick="copyMsg(this,' + i + ',false)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copiar mensaje</button>';
    h += '</div><div class="wa-bubble-container"><div class="wa-bubble">' + msg.text + '<div class="wa-time">' + timeStr + ' \u2713\u2713</div></div></div></div>';
  }
  document.getElementById("results").innerHTML = h;
  window._msgs = result.messages;
}

function renderMassResults(planName, renta, gb, premium, result) {
  var saving=premium.saving, saves=saving>0;
  var h = "";
  h += '<div class="comparison"><div class="comparison-title">Comparativa del grupo: ' + planName + '</div>';
  h += '<div class="compare-grid"><div class="compare-box old"><div class="box-label">Plan Actual</div>';
  h += '<div class="plan-name">' + planName + '</div><div class="plan-price">$' + renta + '</div>';
  h += '<div class="plan-data">' + gb + ' GB + redes sociales</div></div>';
  h += '<div class="compare-arrow">\u2192</div>';
  h += '<div class="compare-box new"><div class="box-label">Plan Premium</div>';
  h += '<div class="plan-name">' + premium.name + '</div><div class="plan-price">$' + premium.renta + '</div>';
  h += '<div class="plan-data">' + premium.gb + ' GB + 6 apps + EUA/CAN</div></div></div>';
  h += '<div class="savings-strip">';
  h += '<div class="saving-item"><div class="val" style="color:' + (saves?"#10B981":saving===0?"#009FDB":"#F59E0B") + '">' + (saves?"-$"+saving+"/mes":saving===0?"$0":"+$"+Math.abs(saving)+"/mes") + '</div><div class="lbl">' + (saves?"Ahorro mensual":saving===0?"Mismo precio":"Diferencia") + '</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#009FDB">' + premium.gbMultiple + 'x</div><div class="lbl">Mas datos</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#10B981">' + premium.gb + ' GB</div><div class="lbl">Navegacion libre</div></div>';
  if (saves) h += '<div class="saving-item"><div class="val" style="color:#10B981">$' + (saving*12) + '/a\u00f1o</div><div class="lbl">Ahorro anual</div></div>';
  h += '</div></div>';
  h += '<div class="scenario-tip"><div class="tip-icon">\ud83d\udca1</div><div class="tip-text">' + result.tip + '</div></div>';
  var tags = ["tag-a","tag-b","tag-c","tag-d"];
  var now = new Date();
  var timeStr = ("0"+now.getHours()).slice(-2) + ":" + ("0"+now.getMinutes()).slice(-2);
  for (var i = 0; i < result.messages.length; i++) {
    var msg = result.messages[i];
    h += '<div class="msg-card"><div class="msg-header"><span class="tag ' + tags[i] + '">' + msg.tag + '</span>';
    h += '<button class="btn-copy" onclick="copyMsg(this,' + i + ',true)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copiar mensaje</button>';
    h += '</div><div class="wa-bubble-container"><div class="wa-bubble">' + msg.text + '<div class="wa-time">' + timeStr + ' \u2713\u2713</div></div></div></div>';
  }
  document.getElementById("mass-results").innerHTML = h;
  window._massMsgs = result.messages;
}

// ================================================================
// COPY (Safari iOS safe)
// ================================================================
function copyMsg(btn, idx, isMass) {
  try {
    var msgs = isMass ? window._massMsgs : window._msgs;
    var text = msgs[idx].text.replace(/\n{3,}/g, "\n\n");
    // Fallback copy method that works everywhere
    var ta = document.createElement("textarea");
    ta.value = text;
    ta.style.position = "fixed";
    ta.style.left = "-9999px";
    ta.style.top = "-9999px";
    ta.style.opacity = "0";
    document.body.appendChild(ta);
    ta.focus();
    ta.select();
    document.execCommand("copy");
    document.body.removeChild(ta);
    btn.className = "btn-copy copied";
    btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg> Copiado!';
    showToast();
    setTimeout(function() {
      btn.className = "btn-copy";
      btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copiar mensaje';
    }, 2000);
  } catch(e) { alert("Error al copiar: " + e.message); }
}

function showToast() {
  var t = document.getElementById("toast");
  t.classList.add("show");
  setTimeout(function() { t.classList.remove("show"); }, 2500);
}

// ================================================================
// TABS
// ================================================================
function switchTab(tab) {
  var btns = document.querySelectorAll(".tab-btn");
  btns[0].classList.toggle("active", tab === "personal");
  btns[1].classList.toggle("active", tab === "masivo");
  btns[2].classList.toggle("active", tab === "renovacion");
  document.getElementById("tab-personal").classList.toggle("active", tab === "personal");
  document.getElementById("tab-masivo").classList.toggle("active", tab === "masivo");
  document.getElementById("tab-renovacion").classList.toggle("active", tab === "renovacion");
}

// ================================================================
// AUTO HINTS
// ================================================================
document.getElementById("planAnterior").addEventListener("change", function() {
  var k = this.value;
  if (!k) { document.getElementById("premium-hint").textContent = ""; return; }
  var plan = PLANS[k], ro = document.getElementById("rentaOverride").value.trim();
  var r = ro ? parseInt(ro.replace(/[^0-9]/g,"")) : plan.renta;
  var b = findBestPremium(r, plan.gb);
  if (b) document.getElementById("premium-hint").innerHTML = "\ud83d\udca1 Sugerencia: <b>" + b.name + "</b> ($" + b.renta + "/mes, " + b.gb + " GB) \u2014 " + (b.saving>0?"ahorra $"+b.saving+"/mes":b.saving===0?"mismo precio":"solo $"+Math.abs(b.saving)+" mas");
});
document.getElementById("massPlan").addEventListener("change", function() {
  var k = this.value;
  if (!k) { document.getElementById("mass-premium-hint").textContent = ""; return; }
  var plan = PLANS[k];
  var b = findBestPremium(plan.renta, plan.gb);
  if (b) document.getElementById("mass-premium-hint").innerHTML = "\ud83d\udca1 Sugerencia: <b>" + b.name + "</b> ($" + b.renta + "/mes, " + b.gb + " GB) \u2014 " + (b.saving>0?"ahorra $"+b.saving+"/mes":b.saving===0?"mismo precio":"solo $"+Math.abs(b.saving)+" mas");
});

function shake(id) {
  var el = document.getElementById(id);
  el.style.borderColor = "#EF4444";
  el.style.animation = "shake .4s ease";
  setTimeout(function() { el.style.animation = ""; el.style.borderColor = ""; }, 500);
}

// ================================================================
// RENOVATION PREMIUM
// ================================================================
var selectedRenScenario = "primer_contacto";

function selectRenScenario(btn) {
  var btns = document.querySelectorAll("[data-ren-scenario]");
  for (var i=0;i<btns.length;i++) btns[i].classList.remove("active");
  btn.classList.add("active");
  selectedRenScenario = btn.getAttribute("data-ren-scenario");
}

function getRenMessages(planKey, planData, firstName, agent) {
  var pN = planKey;
  var pR = planData.renta;
  var pG = planData.gb;
  var saludo = firstName ? "Estimado " + firstName + "! \ud83d\udc8e" : "Estimado cliente Premium! \ud83d\udc8e";
  var saludoCorto = firstName ? firstName + ", " : "";

  var templates = {
    primer_contacto: {
      tip: "<b>Tip:</b> Primer contacto Premium. Ve directo al beneficio del equipo.",
      messages: [
        { tag: "Opcion A \u2014 Estilo original",
          text: L(saludo, "", "Tu linea cuenta con *beneficios exclusivos* gracias al nivel de cliente que tienes en donde AT&T te otorga un *equipo sin costo* \ud83d\udcf1 por tu misma renta de *$" + pR + "/mes* con *" + pG + " GB* o si lo prefieres puedes adquirir el equipo que tu desees con *grandes descuentos* significativos \ud83e\udd11", "", "Tu numero, fechas de corte y pago *no cambian* y el proceso es muy sencillo \u2705", "", "Responde la opcion deseada \ud83d\udc47", "1)*Me interesa el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo* \ud83d\udcb0", "3)*Me interesa un plan con mas GB* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion B \u2014 Exclusividad + marcas",
          text: L("\ud83c\udf1f " + saludo, "", "Por ser cliente *" + pN + "* con *" + pG + " GB* a *$" + pR + "/mes* tienes acceso a beneficios que no estan disponibles para todos \ud83d\udd12", "", "\ud83c\udd93 *Equipo sin costo* \u2014 reclama el dispositivo que ya te corresponde", "\ud83d\udcf2 *Descuentos exclusivos* \u2014 iPhone, Samsung, Motorola y las mejores marcas", "\ud83d\udcca *Mejora de plan* \u2014 si necesitas mas gigas tambien podemos ayudarte", "", "Lo mejor es que *nada cambia*: mismo numero, misma renta de *$" + pR + "*, misma fecha de corte \ud83d\udc4c", "", "Elige una opcion \ud83d\ude80", "1)*Quiero mi equipo sin costo* \ud83d\udcf1", "2)*Me interesa cotizar un equipo con descuento* \ud83e\udd11", "3)*Quiero conocer planes con mas GB* \ud83d\udcca", "4) No deseo ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion C \u2014 Breve y curioso",
          text: L("\ud83d\udc4b " + saludo, "", "Sabias que por ser cliente *" + pN + "* tienes derecho a un *equipo nuevo*? \ud83d\udcf1", "", "\u2705 Sin costo adicional", "\u2705 Tu plan de *" + pG + " GB* a *$" + pR + "/mes* no cambia", "\u2705 Sin cambiar tu numero ni fecha de pago", "\u2705 Todo por telefono en minutos", "", "O si prefieres, elige el smartphone que mas te guste con *descuentos exclusivos* \ud83e\udd11", "", "Que te gustaria hacer? \ud83d\udc47", "1)*Quiero el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo premium* \ud83d\udcb0", "3)*Me interesan mas GB en mi plan* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion D \u2014 Beneficios enumerados",
          text: L("\ud83d\udc8e " + saludo, "", "AT&T quiere *premiarte* por tu preferencia. Como cliente *" + pN + "* (*" + pG + " GB* a *$" + pR + "/mes*) estos son tus beneficios:", "", "\ud83d\udcf1 *Equipo sin costo* incluido en tu renovacion", "\ud83e\udd11 *Descuentos increibles* en las mejores marcas", "\ud83d\ude80 *Opcion de mejorar tu plan* si necesitas mas gigas", "\ud83d\udd04 *Linea adicional* disponible sin plazo establecido", "", "Tu numero, renta y fechas de pago se mantienen igual \u2705", "", "Dinos como podemos ayudarte \ud83d\udc47", "1)*Me interesa el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo* \ud83d\udcb0", "3)*Me interesa un plan con mas GB* \ud83d\ude80", "4)*Quiero una linea adicional* \ud83d\udcf2", "5) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") }
      ]
    },
    seguimiento: {
      tip: "<b>Tip:</b> Cambia el angulo y recuerdale que el beneficio sigue disponible.",
      messages: [
        { tag: "Opcion A \u2014 Recordatorio amable",
          text: L("\ud83d\udc4b " + saludoCorto + "te escribimos nuevamente de AT&T.", "", "Tu beneficio como cliente *" + pN + "* (*" + pG + " GB* a *$" + pR + "/mes*) sigue disponible \u2705", "", "Puedes llevarte un *equipo sin costo* \ud83d\udcf1 o adquirir el smartphone de tu preferencia con *descuentos exclusivos* \ud83e\udd11", "", "Tu renta de *$" + pR + "*, numero y fechas de pago *no cambian* \ud83d\udc4c", "", "Elige una opcion \ud83d\udc47", "1)*Me interesa el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo* \ud83d\udcb0", "3)*Me interesa un plan con mas GB* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion B \u2014 Pregunta directa",
          text: L(saludoCorto + "una pregunta rapida \u261d\ufe0f", "", "Ya revisaste los equipos disponibles para ti como cliente *" + pN + "*? \ud83d\udcf1", "", "Tienes un equipo *sin costo* esperandote o puedes elegir entre las mejores marcas con *descuentos significativos* \ud83e\udd11", "", "Tu plan de *" + pG + " GB* a *$" + pR + "/mes* se mantiene igual \u2705", "", "Te gustaria saber tus opciones? \ud83d\udc47", "1)*Si, quiero el equipo sin costo* \ud83d\udcf1", "2)*Quiero ver equipos con descuento* \ud83d\udcb0", "3)*Prefiero mejorar mi plan primero* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion C \u2014 Lo que pierde",
          text: L("\u23f3 " + saludoCorto + "tu beneficio Premium sigue activo pero tiene vigencia.", "", "\ud83d\udcf1 *Equipo sin costo* \u2014 ya incluido por ser cliente *" + pN + "*", "\ud83e\udd11 *Descuentos exclusivos* \u2014 en iPhone, Samsung y mas", "\ud83d\ude80 *Mejora de plan* \u2014 mas GB si lo necesitas", "", "Tu plan de *" + pG + " GB* a *$" + pR + "/mes* no cambia \u2705", "", "Elige antes de que venza \ud83d\udc47", "1)*Me interesa el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo* \ud83d\udcb0", "3)*Me interesa mas GB* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion D \u2014 Ultra breve",
          text: L("\ud83d\udc4b " + saludoCorto + "recordatorio rapido:", "", "Tu *equipo sin costo* como cliente *" + pN + "* (*" + pG + " GB, $" + pR + "/mes*) sigue disponible \ud83d\udcf1", "", "Tambien puedes elegir otro equipo con *grandes descuentos* \ud83e\udd11", "", "1)*Quiero el equipo sin costo* \ud83d\udcf1", "2)*Cotizar un equipo* \ud83d\udcb0", "3)*Mas informacion* \ud83d\ude80", "4) No contactar", "", "*AT&T Cambia el juego* \ud83d\ude09") }
      ]
    },
    equipo: {
      tip: "<b>Tip:</b> Foco 100% en el equipo y las marcas.",
      messages: [
        { tag: "Opcion A \u2014 Marcas destacadas",
          text: L("\ud83d\udcf1 " + saludo, "", "Como cliente *" + pN + "* (*" + pG + " GB* a *$" + pR + "/mes*) tienes acceso a *beneficios exclusivos*:", "", "\ud83c\udf4e *iPhone* \u2014 ultimos modelos con descuentos significativos", "\ud83d\udcf1 *Samsung Galaxy* \u2014 la mejor tecnologia Android", "\u26a1 *Motorola* \u2014 rendimiento increible a precios accesibles", "\ud83c\udf1f *Xiaomi* \u2014 innovacion y calidad con grandes descuentos", "", "O llevate un *equipo totalmente sin costo* \ud83c\udd93", "", "Tu renta de *$" + pR + "/mes* y tu numero no cambian \u2705", "", "Que te interesa? \ud83d\udc47", "1)*Quiero el equipo sin costo* \ud83c\udd93", "2)*Quiero cotizar un iPhone* \ud83c\udf4e", "3)*Quiero cotizar un Samsung* \ud83d\udcf1", "4)*Quiero ver otra marca* \ud83c\udf1f", "5) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion B \u2014 Sin costo protagonista",
          text: L("\ud83c\udd93 " + saludo, "", "Tienes un *equipo nuevo esperandote SIN COSTO* como cliente *" + pN + "* \ud83d\udcf1", "", "\u2705 Eliges tu equipo sin costo", "\u2705 Conservas tu plan de *" + pG + " GB* a *$" + pR + "/mes*", "\u2705 Tu numero y fecha de pago no cambian", "\u2705 Todo por telefono en minutos", "", "Si prefieres *gama alta*, tenemos *descuentos exclusivos* \ud83e\udd11", "", "Que prefieres? \ud83d\udc47", "1)*Me llevo el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo con descuento* \ud83d\udcb0", "3)*Quiero ver las marcas disponibles* \ud83c\udf1f", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion C \u2014 Celular viejo vs nuevo",
          text: L("\ud83d\udcf2 " + saludo, "", "Si tu celular ya esta lento o la bateria no dura... este es el momento perfecto \u26a1", "", "Como cliente *" + pN + "* (*" + pG + " GB, $" + pR + "/mes*) tienes:", "", "\ud83c\udd93 *Equipo sin costo* \u2014 para que estrenes ya", "\ud83e\udd11 *Descuentos de hasta 40%* en equipos de gama alta", "\ud83d\udcf1 Las *mejores marcas*: iPhone, Samsung, Motorola, Xiaomi", "", "Tu numero, renta y fechas de pago no cambian \u2705", "", "Listo para estrenar? \ud83d\udc47", "1)*Quiero el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo premium* \ud83d\udcb0", "3)*Me interesa un plan con mas GB* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion D \u2014 Urgencia en equipo",
          text: L("\u26a0\ufe0f " + saludoCorto + "los equipos disponibles para clientes *" + pN + "* tienen *stock limitado* \ud83d\udcf1", "", "\ud83c\udd93 *Equipo sin costo* disponible ahora", "\ud83e\udd11 *Descuentos exclusivos* en iPhone, Samsung y mas", "\u2705 Tu plan de *" + pG + " GB* a *$" + pR + "/mes* no cambia", "", "Elige antes de que se agoten \ud83d\udc47", "1)*Quiero el equipo sin costo* \ud83d\udcf1", "2)*Cotizar equipo con descuento* \ud83d\udcb0", "3)*Mas GB en mi plan* \ud83d\ude80", "4) No contactar por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") }
      ]
    },
    urgencia: {
      tip: "<b>Tip:</b> Ultimo intento. El beneficio esta por vencer.",
      messages: [
        { tag: "Opcion A \u2014 Ultimo aviso formal",
          text: L("\ud83d\udea8 " + saludoCorto + "este es un *ultimo aviso* importante.", "", "Tu beneficio como cliente *" + pN + "* (*" + pG + " GB* a *$" + pR + "/mes*) esta por vencer:", "", "\ud83d\udcf1 *Equipo sin costo* \u2014 solo por tiempo limitado", "\ud83e\udd11 *Descuentos exclusivos* \u2014 en las mejores marcas", "\ud83d\ude80 *Mejora de plan* \u2014 mas GB si los necesitas", "", "Despues de esta fecha *no podemos garantizar las mismas condiciones* \u23f3", "", "Tu renta de *$" + pR + "* y fechas de pago *no cambian* \u2705", "", "Elige \ud83d\udc47", "1)*Me interesa el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo* \ud83d\udcb0", "3)*Me interesa un plan con mas GB* \ud83d\ude80", "4) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion B \u2014 Escasez + beneficio",
          text: L("\u23f3 " + saludoCorto + "tu ventana para reclamar tu equipo como cliente *" + pN + "* se esta cerrando.", "", "\u274c Si no renuevas \u2192 pierdes el equipo sin costo", "\u274c Si no renuevas \u2192 pierdes los descuentos exclusivos", "\u2705 Si renuevas \u2192 equipo nuevo + mismo plan (*" + pG + " GB, $" + pR + "/mes*)", "", "No cambia absolutamente nada de tu plan \ud83d\udc4c", "", "No lo dejes para despues \ud83d\udc47", "1)*Quiero mi equipo sin costo ya* \ud83d\udcf1", "2)*Cotizar equipo con descuento* \ud83d\udcb0", "3)*Mas informacion* \ud83d\ude80", "4) No contactar por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion C \u2014 Directo y corto",
          text: L("\ud83d\udea8 *Ultima oportunidad* " + (firstName || "cliente Premium") + "!", "", "Tu equipo sin costo \ud83d\udcf1 y tus descuentos \ud83e\udd11 de tu plan *" + pN + "* (*" + pG + " GB, $" + pR + "/mes*) estan por vencer.", "", "Mismo numero \u2705 Misma renta \u2705 Mismas fechas \u2705", "", "1)*Quiero el equipo sin costo* \ud83d\udcf1", "2)*Cotizar equipo* \ud83d\udcb0", "3)*Mejorar plan* \ud83d\ude80", "4) No contactar", "", "*AT&T Cambia el juego* \ud83d\ude09") },
        { tag: "Opcion D \u2014 Completo con linea",
          text: L("\ud83d\udea8 " + saludoCorto + "tu beneficio como cliente *" + pN + "* (*" + pG + " GB, $" + pR + "/mes*) vence pronto.", "", "Tienes derecho a:", "", "\ud83d\udcf1 *Equipo sin costo* en tu renovacion", "\ud83e\udd11 *Descuentos significativos* en el equipo que elijas", "\ud83d\ude80 *Mas GB* si necesitas mejorar tu plan", "\ud83d\udcf2 *Linea adicional* sin plazo establecido", "", "Tu numero, renta y fechas *se mantienen igual* \u2705", "", "Elige \ud83d\udc47", "1)*Me interesa el equipo sin costo* \ud83d\udcf1", "2)*Quiero cotizar un equipo* \ud83d\udcb0", "3)*Me interesa un plan con mas GB* \ud83d\ude80", "4)*Quiero una linea adicional* \ud83d\udcf2", "5) No quiero ser contactado por este medio", "", "*AT&T Cambia el juego* \ud83d\ude09") }
      ]
    }
  };
  return templates[selectedRenScenario];
}

function generateRenMessages() {
  try {
    var planKey = document.getElementById("renPlan").value;
    var name = document.getElementById("renName").value.trim();
    var agent = document.getElementById("renAgent").value.trim();
    if (!planKey) { shake("renPlan"); return; }
    var planData = PREMIUM[planKey];
    var firstName = name ? name.split(" ")[0] : "";
    var result = getRenMessages(planKey, planData, firstName, agent);
    renderRenResults(planKey, planData, result);
  } catch(e) { alert("Error renovacion: " + e.message); }
}

function renderRenResults(planKey, planData, result) {
  var h = "";
  // Plan card (no comparison needed, same plan)
  h += '<div class="comparison" style="border-color:rgba(139,92,246,0.2)">';
  h += '<div class="comparison-title" style="color:var(--purple)">Renovacion: ' + planKey + '</div>';
  h += '<div style="display:flex;justify-content:center;gap:30px;padding:10px 0">';
  h += '<div class="saving-item"><div class="val" style="color:var(--purple)">' + planKey + '</div><div class="lbl">Plan actual = Plan renovado</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#10B981">' + planData.gb + ' GB</div><div class="lbl">Se mantiene</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#009FDB">$' + planData.renta + '/mes</div><div class="lbl">Misma tarifa</div></div>';
  h += '<div class="saving-item"><div class="val" style="color:#F59E0B">\ud83d\udcf1</div><div class="lbl">+ Equipo</div></div>';
  h += '</div></div>';
  h += '<div class="scenario-tip"><div class="tip-icon">\ud83d\udca1</div><div class="tip-text">' + result.tip + '</div></div>';
  var tags = ["tag-a","tag-b","tag-c","tag-d"];
  var now = new Date();
  var timeStr = ("0"+now.getHours()).slice(-2) + ":" + ("0"+now.getMinutes()).slice(-2);
  for (var i = 0; i < result.messages.length; i++) {
    var msg = result.messages[i];
    h += '<div class="msg-card"><div class="msg-header"><span class="tag ' + tags[i] + '">' + msg.tag + '</span>';
    h += '<button class="btn-copy" onclick="copyRenMsg(this,' + i + ')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copiar mensaje</button>';
    h += '</div><div class="wa-bubble-container"><div class="wa-bubble">' + msg.text + '<div class="wa-time">' + timeStr + ' \u2713\u2713</div></div></div></div>';
  }
  document.getElementById("ren-results").innerHTML = h;
  window._renMsgs = result.messages;
}

function copyRenMsg(btn, idx) {
  try {
    var text = window._renMsgs[idx].text.replace(/\n{3,}/g, "\n\n");
    var ta = document.createElement("textarea");
    ta.value = text; ta.style.position = "fixed"; ta.style.left = "-9999px"; ta.style.top = "-9999px"; ta.style.opacity = "0";
    document.body.appendChild(ta); ta.focus(); ta.select(); document.execCommand("copy"); document.body.removeChild(ta);
    btn.className = "btn-copy copied";
    btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg> Copiado!';
    showToast();
    setTimeout(function() {
      btn.className = "btn-copy";
      btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copiar mensaje';
    }, 2000);
  } catch(e) { alert("Error al copiar: " + e.message); }
}

// Error handler
window.onerror = function(msg, url, line) { alert("Error linea " + line + ": " + msg); };
</script>
</body>
</html>
